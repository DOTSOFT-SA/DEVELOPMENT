# 'Development-db' App
### Δημιουργία Πινάκων Web App στη Βάση Δεδομένων της DOTSOFT

## Περιγραφή
Για την υλοποίηση του πρότζεκτ, είναι απαραίτητο η βάση δεδομένων `PostgreSQL` της Dotsoft να περιλαμβάνει τους πίνακες όπου η Web App πλατφόρμα χρειάζεται. Συνολικά, η εφαρμογή στοχεύει στη δημιουργία των παρακάτω πινάκων:

1. **`login_user`**: Αποθηκεύονται οι πληροφορίες των χρηστών που μπορούν να συνδεθούν στο σύστημα. Περιλαμβάνει το email, τον κωδικό πρόσβασης (με κρυπτογράφηση), πότε δημιουργήθηκε και πότε συνδέθηκε τελευταία φορά ο χρήστης κλπα.
2. **`privilege`**: Καταγράφονται οι κατηγορίες δικαιωμάτων των χρηστών, όπως `ΔΙΑΧΕΙΡΙΣΤΗΣ`, `ΠΡΟΒΛΕΨΗ ΖΗΤΗΣΗΣ`, `ΣΥΝΙΣΤΩΜΕΝΗ ΠΟΣΟΤΗΤΑ ΑΠΟΘΕΜΑΤΩΝ` και `ΔΡΟΜΟΛΟΓΗΣΗ`.
3. **`user_privilege (join table)`**: Ορίζει ποιοι χρήστες έχουν ποια δικαιώματα, επιτρέποντας έναν χρήστη να έχει πολλαπλά δικαιώματα πρόσβασης.
4. **`sku_metric`**: Αποθηκεύει δεδομένα που σχετίζονται με μετρήσεις και εξωτερικούς παράγοντες που επηρεάζουν τη ζήτηση (π.χ., καιρός, google trends, web scraping, sentiment analysis κλπα)
5. **`sku_quantity_prediction`**: Αποθηκεύει δεδομένα από τις προβλέψεις SKU ποσοτήτων (ζήτησης).
6. **`inventory_optimization`**: Καταγράφει δεδομένα βελτιστοποίησης αποθεμάτων (βέλτιστη ποσότητα παραγγελίας, σημείο επαναπαραγγελίας, συνολικό κόστος κλπα).
7. **`distribution_optimization`**: Αποθήκευση δεδομένων που αφορούν το βέλτιστο πλάνο διαδρομής και διανομής των οχημάτων.
8. **`ml_model`**: Αποθηκεύει τα δεδομένα από τα εκπαιδευμένα ML μοντέλα (σε δυαδική μορφή) για εύκολη ανάκτηση και χρήση.
9. **`user_erp_api`**: Καταγράφει τις πληροφορίες σύνδεσης των πελατών με τα δικά τους ERP συστήματα.

Για περισσότερες πληροφορίες, δείτε το **ERD Figma σχεδιάγραμμα [εδώ](https://www.figma.com/board/SYBXYTliEC9o7ELte12N9v/DEVELOPMENT-DIAGRAMS?node-id=0-1&t=RopbeAnhkUKLtXaO-1)**

---

## Πώς να Τρέξετε τo App Τοπικά

**Σημαντική σημείωση**: Πριν τρέξετε την εφαρμογή, βεβαιωθείτε ότι η 'Development' `PostgreSQL` βάση και το `development-backend` πρότζεκτ είναι ήδη ενεργοποιημένα.

1.Δημιουργήστε ένα νέο (κενό) πρότζεκτ με το αγαπημένο σας IDE (π.χ., PyCharm)

2.Από το repository, κλωνοποιήστε/κατεβάστε τον φάκελο `db-development` και μετακινήστε τα αρχεία του στο νέο πρότζεκτ

* To αρχείο `.env` πρέπει να τοποθετηθεί στον root φάκελο του πρότζεκτ (βασιστείτε στο αρχείο `.env.sample`).
* Το αρχείο `users.json` που περιλαμβάνει τα στοιχεία των χρηστών για τις εγγραφές, πρέπει να τοποθετηθεί στον φάκελο `app/configs`. 
* Το αρχείο `users_erp_api.json` που περιλαμβάνει τα στοιχεία ERP APIs των χρηστών, πρέπει να τοποθετηθεί στον φάκελο `app/configs`.
* Τα παραπάνω αρχεία πρέπει να **δοθούν από τον υπεύθυνο του έργου**.

3.Δημιουργήστε έναν `venv` φάκελο για το πρότζεκτ (δείτε πως [εδώ](https://stackoverflow.com/a/59895890))

4.Εκτελέστε την εντολή `pip install -r requirements.txt` για να εγκαταστήσετε τα απαραίτητα πακέτα/βιβλιοθήκες

5.Τρέξτε το αρχείο `main.py` στο terminal με την εντολή: `python main.py`

---

## Περιγραφή Πινάκων

### `login_user`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός χρήστη
  - `email`: Διεύθυνση email (μοναδική)
  - `password`: Κωδικός πρόσβασης (κρυπτογραφημένος)
  - `role`: Ρόλος του χρήστη (π.χ., ADMIN ή USER)
  - `is_active`: Αν ο χρήστης είναι ενεργός ή όχι
  - `updated_at`: Χρονική σήμανση τελευταίας ενημέρωσης προφίλ του χρήστη
  - `created_at`: Χρονική σήμανση δημιουργίας χρήστη
  - `login_at`: Χρονική σήμανση τελευταίας σύνδεσης του χρήστη

### `privilege`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε δικαίωμα.
  - `name`: Όνομα του δικαιώματος (`ΔΙΑΧΕΙΡΙΣΤΗΣ`, `ΠΡΟΒΛΕΨΗ ΖΗΤΗΣΗΣ`, `ΣΥΝΙΣΤΩΜΕΝΗ ΠΟΣΟΤΗΤΑ ΑΠΟΘΕΜΑΤΩΝ`, `ΔΡΟΜΟΛΟΓΗΣΗ`).

### `user_privilege (join table)`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός εγγραφής.
  - `is_enabled`: Αν το δικαίωμα είναι ενεργό ή όχι.
  - `updated_at`: Χρονική σήμανση τελευταίας ενημέρωσης.
  - `created_at`: Χρονική σήμανση δημιουργίας.
  - `user_id` (FK): Αναγνωριστικό του χρήστη (συσχέτιση με `login_user.id`).
  - `privilege_id` (FK): Αναγνωριστικό του δικαιώματος (συσχέτιση με `privilege.id`).
  - <u>Μοναδικότητα</u>: Ένας χρήστης δεν μπορεί να έχει το ίδιο δικαίωμα περισσότερες από μία φορές (`UniqueConstraint('user_id', 'privilege_id')`).

### `sku_metric`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε εγγραφή
  - `sku_number`: Αναγνωριστικό του SKU
  - `is_weekend`: Δείκτης αν τα δεδομένα (της παραγγελίας) αφορούν Σαββατοκύριακο
  - `is_holiday`: Δείκτης αν τα δεδομένα (της παραγγελίας) αφορούν αργία
  - `mean_temperature`: Μέση θερμοκρασία κατά την περίοδο
  - `rain`: Δείκτης για την ύπαρξη βροχής εκείνη την περίοδο
  - `average_competition_price_external`: Δεδομένα για τις τιμές ανταγωνιστών
  - `review_sentiment_score`: Βαθμολογία ανάλυσης συναισθημάτων από κριτικές που συλλέχθηκαν μέσω scraping
  - `review_sentiment_timestamp`: Χρονική σήμανση που δημιουργήθηκε το `review_sentiment_score`
  - `trend_value`: Δείκτης τάσεων από Google Trends
  - `updated_at`: Αυτόματη χρονική σήμανση δημιουργίας/ενημέρωσης εγγραφής
  - `sku_order_record_id` (Μοναδικό): Μοναδικός αναγνωριστικός αριθμός για δεδομένα SKU (**`sku_metric.sku_order_record_id` [DOTSOFT βάση] == `sku_order_development.id` [ERP βάση]**).
  - `user_id` (FK): Αφορά το ID του web app χρήστη στον πίνακα `login_user`

### `sku_quantity_prediction`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε εγγραφή/πρόβλεψη
  - `model_name`: Όνομα του βέλτιστου ML μοντέλου που χρησιμοποιήθηκε
  - `sku_number`: Αναγνωριστικό του SKU που ζητήθηκε η πρόβλεψη
  - `week_number`: Εβδομάδα για την οποία έγινε η πρόβλεψη
  - `predicted_value`: Προβλεπόμενη ποσότητα/ζήτηση για το SKU
  - `mape`: Μέσο Απόλυτο Ποσοστιαίο Σφάλμα της πρόβλεψης
  - `mad`: Μέσο Απόλυτο Σφάλμα της πρόβλεψης
  - `updated_at`: Αυτόματη χρονική σήμανση δημιουργίας/ενημέρωσης εγγραφής
  - `sku_order_record_id` (FK): Αφορά το `sku_order_record_id` στον πίνακα `sku_metric` (enforce referential integrity so that before the **sku_quantity_prediction** table, `sku_order_record_id` must already exist in the **sku_metric** table)
  - `user_id` (FK): Αφορά το ID του web app χρήστη στον πίνακα `login_user`

### `inventory_optimization`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε εγγραφή
  - `sku_number`: Αναγνωριστικό του SKU που ζητήθηκε η πρόβλεψη
  - `order_quantity_q`: Συνιστώμενη ποσότητα για την επόμενη παραγγελία
  - `reorder_point_r`: Επίπεδο αποθέματος στο οποίο ενεργοποιείται η αναπαραγγελία
  - `holding_cost`: Κόστος διατήρησης αποθέματος
  - `setup_transportation_cost`: Κόστος οργάνωσης και μεταφοράς
  - `stockout_cost`: Κόστος αποθέματος
  - `total_cost`: Συνολικό κόστος διαδικασίας
  - `order_frequency`: Συχνότητα παραγγελίας (λ / Q)
  - `cycle_time`: Μέση Διάρκεια Κύκλου (Q / λ) - Πόσος χρόνος περνά ανάμεσα σε δύο παραγγελίες
  - `is_custom`: Οι παράμετροι αποθέματος (inventory parameters) παρέχονται από το frontend χρήστη (True) ή προέρχονται από τη βάση δεδομένων ERP (False)
  - `updated_at`: Αυτόματη χρονική σήμανση δημιουργίας/ενημέρωσης εγγραφής
  - `inventory_record_id`: αναγνωριστικός αριθμός αποθήκης (**`inventory_optimization.inventory_record_id` [DOTSOFT βάση] == `inventory_params_development.id` [ERP βάση]**).
  - `user_id` (FK): Αφορά το ID του web app χρήστη στον πίνακα `login_user`

### `distribution_optimization`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε εγγραφή
  - `total_cost`: Συνολικό κόστος για το πλάνο διανομής
  - `vehicle_id`: Αναγνωριστικό του (βέλτιστου) οχήματος που χρησιμοποιήθηκε
  - `start_location_name`: Όνομα σημείου εκκίνησης διανομής
  - `destination_location_name`: Όνομα σημείου προορισμού
  - `units`: Μεταφερόμενες μονάδες (αριθμός δεμάτων)
  - `updated_at`: Αυτόματη χρονική σήμανση δημιουργίας/ενημέρωσης εγγραφής
  - `user_id` (FK): Αφορά το ID του web app χρήστη στον πίνακα `login_user`

### `ml_model`

- **Πεδία**:
  - `id` (PK): Μοναδικός αναγνωριστικός αριθμός για κάθε εγγραφή μοντέλου.
  - `model_type`: Τύπος του μοντέλου (π.χ., `sku_quantity_prediction_ml_model`).
  - `model_name`: Όνομα του ML μοντέλου που χρησιμοποιήθηκε (π.χ., `DecisionTreeRegressor`).
  - `model_file`: Το αρχείο του εκπαιδευμένου μοντέλου σε δυαδική μορφή (.sav file).
  - `mape`: Μέσο Απόλυτο Ποσοστιαίο Σφάλμα του μοντέλου.
  - `mad`: Μέσο Απόλυτο Σφάλμα του μοντέλου.
  - `model_features`: Οι παράμετροι που χρησιμοποιήθηκαν για την εκπαίδευση του μοντέλου.
  - `updated_at`: Αυτόματη χρονική σήμανση δημιουργίας/ενημέρωσης εγγραφής.
  - `user_id` (FK): Αφορά το ID του web app χρήστη (συσχέτιση με `login_user.id`).
  - <u>Μοναδικότητα</u>: Ένας χρήστης δεν μπορεί να έχει δύο ή παραπάνω φορές τον ίδιο τύπο μοντέλου, αλλά διαφορετικοί χρήστες μπορούν να έχουν τον ίδιο `model_type` (`UniqueConstraint('model_type', 'user_id')`).

### `user_erp_api`
- **Πεδία**:
  - `id (PK)`: Μοναδικός αναγνωριστικός αριθμός εγγραφής
  - `client_name`: Όνομα του πελάτη (μοναδικό)
  - `login_token_url`: URL για απόκτηση token σύνδεσης
  - `sku_order_url`: URL για παραγγελίες SKU
  - `inventory_params_url`: URL για δεδομένα αποθέματος
  - `distribution_routing_url`: URL για πληροφορίες διανομής
  - `sku_order_latest_url`: URL για τις πιο πρόσφατες παραγγελίες SKU
  - `inventory_params_latest_url`: URL για τα πιο πρόσφατα δεδομένα αποθέματος
  - `token_username`: Όνομα χρήστη για API call authentication
  - `token_password`: Κωδικός πρόσβασης για API call authentication (κρυπτογραφημένος)
  - `user_id (FK)`: Αφορά το ID του web app χρήστη στον πίνακα `login_user`
  - <u>Μοναδικότητα</u>: Ένας χρήστης δεν μπορεί να έχει δύο ή παραπάνω φορές εγγραφή σε αυτόν τον πίνακα (συσχέτιση 1-προς-1 με τον πίνακα login_user (login_user.id))